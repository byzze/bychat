{"file":"/home/luo/go_project/bychat/lib/redislib/redis_lib.go:35","func":"bychat/lib/redislib.InitRedlisClient","level":"info","msg":"初始化redis:PONG","time":"2023-03-05T00:01:11+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:91","func":"bychat/internal/servers/websocket.StartWebSocket","level":"info","msg":"WebSocket 启动程序成功:172.26.61.251:9001","time":"2023-03-05T00:01:11+08:00"}
{"currentTime":1677945673,"file":"/home/luo/go_project/bychat/internal/servers/task/server_node_task.go:37","func":"bychat/internal/servers/task.serverNode","level":"info","msg":"定时任务，服务注册","param":"","server":{"ip":"172.26.61.251","port":"9001"},"time":"2023-03-05T00:01:13+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/home/home.go:22","func":"bychat/api/v1/home.Index","level":"info","msg":"http_request 聊天首页101","time":"2023-03-05T00:01:13+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:5.35 method:GET statusCode:200 uri:/home/index]","time":"2023-03-05T00:01:13+08:00"}
{"AppId":0,"UserId":48,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:197","func":"bychat/internal/servers/websocket.Login","level":"info","msg":"webSocket_request 登录","time":"2023-03-05T00:01:14+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/user/user.go:42","func":"bychat/api/v1/user.Login","id":48,"level":"info","msg":"Login Info","name":"黄庭坚","time":"2023-03-05T00:01:14+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.01 method:POST statusCode:200 uri:/user/login]","time":"2023-03-05T00:01:14+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:99","func":"bychat/internal/servers/websocket.wsPage.func1","level":"info","msg":"升级协议ua:[Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.57]referer:[]","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:107","func":"bychat/internal/servers/websocket.wsPage","level":"info","msg":"webSocket 建立连接:[::1]:52372","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:186","func":"bychat/internal/servers/websocket.(*ClientManager).EventRegister","level":"info","msg":"EventRegister 用户建立连接:","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945673483-218951\",\"cmd\":\"bind\",\"data\":{\"userID\":48,\"appID\":0,\"token\":\"1677945674\"}}","time":"2023-03-05T00:01:15+08:00"}
{"addr":"","data":"{\"seq\":\"1677945673483-218951\",\"cmd\":\"bind\",\"data\":{\"userID\":48,\"appID\":0,\"token\":\"1677945674\"}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:15+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:15+08:00","userKey":48}
{"cmd":"bind","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945673483-218951\",\"cmd\":\"bind\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:192","func":"bychat/internal/servers/websocket.(*ClientManager).EvenBindUser","level":"info","msg":"EvenBindUser 用户信息绑定:","time":"2023-03-05T00:01:15+08:00"}
{"AppId":0,"RoomID":101,"UserId":48,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:154","func":"bychat/internal/servers/websocket.EnterRoom","level":"info","msg":"webSocket_request 进入房间接口","time":"2023-03-05T00:01:15+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:15+08:00","userKey":48}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:160","func":"bychat/internal/servers/websocket.EnterRoom","level":"info","msg":"EnterRoom uo:48","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.8 method:POST statusCode:200 uri:/user/enter]","time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:0.53 method:GET statusCode:200 uri:/user/historyMessageList?roomID=101\u0026start=0\u0026limit=5]","time":"2023-03-05T00:01:15+08:00"}
{"appID":0,"file":"/home/luo/go_project/bychat/api/v1/user/user.go:77","func":"bychat/api/v1/user.GetRoomUserList","level":"info","msg":"http_request 查看全部在线用户 roomID:101","roomID":101,"time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:17","func":"bychat/internal/servers/websocket.GetRoomUserList","level":"info","msg":"获取全部用户","roomID":101,"time":"2023-03-05T00:01:15+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:0.4 method:GET statusCode:200 uri:/user/list?roomID=101]","time":"2023-03-05T00:01:15+08:00"}
{"AppId":0,"UserId":441,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:197","func":"bychat/internal/servers/websocket.Login","level":"info","msg":"webSocket_request 登录","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/user/user.go:42","func":"bychat/api/v1/user.Login","id":441,"level":"info","msg":"Login Info","name":"程颐","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.54 method:POST statusCode:200 uri:/user/login]","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:99","func":"bychat/internal/servers/websocket.wsPage.func1","level":"info","msg":"升级协议ua:[Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.57]referer:[]","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:107","func":"bychat/internal/servers/websocket.wsPage","level":"info","msg":"webSocket 建立连接:[::1]:52374","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:186","func":"bychat/internal/servers/websocket.(*ClientManager).EventRegister","level":"info","msg":"EventRegister 用户建立连接:","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945679210-249235\",\"cmd\":\"bind\",\"data\":{\"userID\":441,\"appID\":0,\"token\":\"1677945680\"}}","time":"2023-03-05T00:01:20+08:00"}
{"addr":"","data":"{\"seq\":\"1677945679210-249235\",\"cmd\":\"bind\",\"data\":{\"userID\":441,\"appID\":0,\"token\":\"1677945680\"}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:20+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945680,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:20+08:00","userKey":441}
{"cmd":"bind","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945679210-249235\",\"cmd\":\"bind\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:192","func":"bychat/internal/servers/websocket.(*ClientManager).EvenBindUser","level":"info","msg":"EvenBindUser 用户信息绑定:","time":"2023-03-05T00:01:20+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945680689-761527\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":441}}","time":"2023-03-05T00:01:22+08:00"}
{"addr":"","data":"{\"seq\":\"1677945680689-761527\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":441}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:22+08:00"}
{"UserId":441,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:22+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945680,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:22+08:00","userKey":441}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945680689-761527\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:22+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/home/home.go:22","func":"bychat/api/v1/home.Index","level":"info","msg":"http_request 聊天首页101","time":"2023-03-05T00:01:22+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:4.92 method:GET statusCode:200 uri:/home/index]","time":"2023-03-05T00:01:22+08:00"}
{"Addr":"","err":"websocket: close 1001 (going away)","file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:55","func":"bychat/internal/servers/websocket.(*Client).read","level":"error","msg":"读取客户端数据 错误","time":"2023-03-05T00:01:22+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:45","func":"bychat/internal/servers/websocket.(*Client).read.func2","level":"info","msg":"读取客户端数据 关闭send\u0026{0 441 [::1]:52374     0xc000567760 0xc0004804e0 1677945680 1677945682 1677945680}","time":"2023-03-05T00:01:22+08:00"}
{"AppId":0,"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:197","func":"bychat/internal/servers/websocket.Login","level":"info","msg":"webSocket_request 登录","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/user/user.go:42","func":"bychat/api/v1/user.Login","id":238,"level":"info","msg":"Login Info","name":"九江王英布","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.12 method:POST statusCode:200 uri:/user/login]","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:99","func":"bychat/internal/servers/websocket.wsPage.func1","level":"info","msg":"升级协议ua:[Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.57]referer:[]","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/init_acc.go:107","func":"bychat/internal/servers/websocket.wsPage","level":"info","msg":"webSocket 建立连接:[::1]:52376","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:186","func":"bychat/internal/servers/websocket.(*ClientManager).EventRegister","level":"info","msg":"EventRegister 用户建立连接:","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945682211-837129\",\"cmd\":\"bind\",\"data\":{\"userID\":238,\"appID\":0,\"token\":\"1677945683\"}}","time":"2023-03-05T00:01:23+08:00"}
{"addr":"","data":"{\"seq\":\"1677945682211-837129\",\"cmd\":\"bind\",\"data\":{\"userID\":238,\"appID\":0,\"token\":\"1677945683\"}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:23+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:23+08:00","userKey":238}
{"cmd":"bind","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945682211-837129\",\"cmd\":\"bind\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:23+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:192","func":"bychat/internal/servers/websocket.(*ClientManager).EvenBindUser","level":"info","msg":"EvenBindUser 用户信息绑定:","time":"2023-03-05T00:01:23+08:00"}
{"AppId":0,"RoomID":101,"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:154","func":"bychat/internal/servers/websocket.EnterRoom","level":"info","msg":"webSocket_request 进入房间接口","time":"2023-03-05T00:01:24+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:24+08:00","userKey":238}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:160","func":"bychat/internal/servers/websocket.EnterRoom","level":"info","msg":"EnterRoom uo:238","time":"2023-03-05T00:01:24+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.3 method:POST statusCode:200 uri:/user/enter]","time":"2023-03-05T00:01:24+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.07 method:GET statusCode:200 uri:/user/historyMessageList?roomID=101\u0026start=0\u0026limit=5]","time":"2023-03-05T00:01:24+08:00"}
{"appID":0,"file":"/home/luo/go_project/bychat/api/v1/user/user.go:77","func":"bychat/api/v1/user.GetRoomUserList","level":"info","msg":"http_request 查看全部在线用户 roomID:101","roomID":101,"time":"2023-03-05T00:01:25+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:17","func":"bychat/internal/servers/websocket.GetRoomUserList","level":"info","msg":"获取全部用户","roomID":101,"time":"2023-03-05T00:01:25+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:1.25 method:GET statusCode:200 uri:/user/list?roomID=101]","time":"2023-03-05T00:01:25+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945683614-182300\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":48}}","time":"2023-03-05T00:01:25+08:00"}
{"addr":"","data":"{\"seq\":\"1677945683614-182300\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":48}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:25+08:00"}
{"UserId":48,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:25+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:25+08:00","userKey":48}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945683614-182300\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:25+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/user/user.go:111","func":"bychat/api/v1/user.SendMessageAll","level":"info","message":"阿萨德","msg":"SendMessageAll","msgID":"1677945688162-272734","roomID":101,"time":"2023-03-05T00:01:29+08:00","userID":238}
{"file":"/home/luo/go_project/bychat/lib/cache/server_cache.go:88","func":"bychat/lib/cache.GetServerNodeAll","key":"acc:hash:server:nodes","level":"info","msg":"GetServerNodeAll","time":"2023-03-05T00:01:29+08:00","valByte":"[\"172.26.61.251:9001\",\"1677945673\"]"}
{"appID":0,"cmd":"msg","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:114","func":"bychat/internal/servers/websocket.SendUserMessageAll","level":"info","message":"阿萨德","msg":"SendUserMessageAll","msgID":"1677945688162-272734","roomID":101,"servers":[{"ip":"172.26.61.251","port":"9001"}],"time":"2023-03-05T00:01:29+08:00","userID":238}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:29+08:00","userKey":238}
{"appID":0,"data":"{\"seq\":\"1677945688162-272734\",\"cmd\":\"msg\",\"response\":{\"code\":0,\"codeMsg\":\"Ok\",\"data\":{\"to\":\"\",\"type\":\"text\",\"msg\":\"阿萨德\",\"from\":\"九江王英布\"}}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:140","func":"bychat/internal/servers/websocket.AllSendMessages","level":"info","msg":"全员广播","roomID":101,"time":"2023-03-05T00:01:29+08:00","userID":238}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:4.62 method:POST statusCode:200 uri:/user/sendMessageAll]","time":"2023-03-05T00:01:29+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945692626-423185\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","time":"2023-03-05T00:01:34+08:00"}
{"addr":"","data":"{\"seq\":\"1677945692626-423185\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:34+08:00"}
{"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:34+08:00"}
{"HeartbeatTime":0,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:34+08:00","userKey":238}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945692626-423185\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:34+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945693504-682499\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":48}}","time":"2023-03-05T00:01:35+08:00"}
{"addr":"","data":"{\"seq\":\"1677945693504-682499\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":48}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:35+08:00"}
{"UserId":48,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:35+08:00"}
{"HeartbeatTime":1677945685,"IsLogoff":false,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:35+08:00","userKey":48}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945693504-682499\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:35+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/systems/system.go:17","func":"bychat/api/v1/systems.Status","level":"info","msg":"http_request 查询系统状态","time":"2023-03-05T00:01:36+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:0.55 method:GET statusCode:200 uri:/system/state]","time":"2023-03-05T00:01:36+08:00"}
{"AppId":0,"UserId":48,"file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:183","func":"bychat/internal/servers/websocket.LogOut","level":"info","msg":"webSocket_request 退出","time":"2023-03-05T00:01:43+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:0.45 method:POST statusCode:200 uri:/user/logout]","time":"2023-03-05T00:01:43+08:00"}
{"HeartbeatTime":1677945695,"IsLogoff":false,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:43+08:00","userKey":48}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client_manager.go:216","func":"bychat/internal/servers/websocket.(*ClientManager).EventUnregister","level":"info","msg":"EventUnregister 用户断开连接","time":"2023-03-05T00:01:43+08:00"}
{"file":"/home/luo/go_project/bychat/lib/cache/server_cache.go:88","func":"bychat/lib/cache.GetServerNodeAll","key":"acc:hash:server:nodes","level":"info","msg":"GetServerNodeAll","time":"2023-03-05T00:01:43+08:00","valByte":"[\"172.26.61.251:9001\",\"1677945673\"]"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:84","func":"bychat/internal/servers/websocket.(*Client).write","level":"info","msg":"Client发送数据 关闭连接:ok:false","time":"2023-03-05T00:01:43+08:00"}
{"appID":0,"cmd":"exit","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:114","func":"bychat/internal/servers/websocket.SendUserMessageAll","level":"info","message":"用户已经离开~","msg":"SendUserMessageAll","msgID":"28652490","roomID":0,"servers":[{"ip":"172.26.61.251","port":"9001"}],"time":"2023-03-05T00:01:43+08:00","userID":48}
{"Addr":"","err":"read tcp [::1]:8089-\u003e[::1]:52372: use of closed network connection","file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:55","func":"bychat/internal/servers/websocket.(*Client).read","level":"error","msg":"读取客户端数据 错误","time":"2023-03-05T00:01:43+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:45","func":"bychat/internal/servers/websocket.(*Client).read.func2","level":"info","msg":"读取客户端数据 关闭send\u0026{0 48 [::1]:52372     0xc000694000 0xc0005900c0 1677945675 1677945695 1677945674}","time":"2023-03-05T00:01:43+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:76","func":"bychat/internal/servers/websocket.(*Client).write.func2","level":"info","msg":"Client发送数据 defer\u0026{0 48 [::1]:52372     0xc000694000 0xc0005900c0 1677945675 1677945695 1677945674}","time":"2023-03-05T00:01:43+08:00"}
{"HeartbeatTime":1677945695,"IsLogoff":true,"LoginTime":1677945674,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:43+08:00","userKey":48}
{"appID":0,"data":"{\"seq\":\"28652490\",\"cmd\":\"exit\",\"response\":{\"code\":0,\"codeMsg\":\"Ok\",\"data\":{\"to\":\"\",\"type\":\"text\",\"msg\":\"用户已经离开~\",\"from\":\"黄庭坚\"}}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:140","func":"bychat/internal/servers/websocket.AllSendMessages","level":"info","msg":"全员广播","roomID":0,"time":"2023-03-05T00:01:43+08:00","userID":48}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945702623-580352\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","time":"2023-03-05T00:01:44+08:00"}
{"addr":"","data":"{\"seq\":\"1677945702623-580352\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:44+08:00"}
{"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:44+08:00"}
{"HeartbeatTime":1677945694,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:44+08:00","userKey":238}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945702623-580352\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:44+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/systems/system.go:17","func":"bychat/api/v1/systems.Status","level":"info","msg":"http_request 查询系统状态","time":"2023-03-05T00:01:45+08:00"}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:0.35 method:GET statusCode:200 uri:/system/state]","time":"2023-03-05T00:01:45+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945712213-802748\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","time":"2023-03-05T00:01:53+08:00"}
{"addr":"","data":"{\"seq\":\"1677945712213-802748\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:01:53+08:00"}
{"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:01:53+08:00"}
{"HeartbeatTime":1677945704,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:53+08:00","userKey":238}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945712213-802748\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:01:53+08:00"}
{"file":"/home/luo/go_project/bychat/api/v1/user/user.go:111","func":"bychat/api/v1/user.SendMessageAll","level":"info","message":"sad","msg":"SendMessageAll","msgID":"1677945713172-697325","roomID":101,"time":"2023-03-05T00:01:54+08:00","userID":238}
{"file":"/home/luo/go_project/bychat/lib/cache/server_cache.go:88","func":"bychat/lib/cache.GetServerNodeAll","key":"acc:hash:server:nodes","level":"info","msg":"GetServerNodeAll","time":"2023-03-05T00:01:54+08:00","valByte":"[\"172.26.61.251:9001\",\"1677945673\"]"}
{"appID":0,"cmd":"msg","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:114","func":"bychat/internal/servers/websocket.SendUserMessageAll","level":"info","message":"sad","msg":"SendUserMessageAll","msgID":"1677945713172-697325","roomID":101,"servers":[{"ip":"172.26.61.251","port":"9001"}],"time":"2023-03-05T00:01:54+08:00","userID":238}
{"HeartbeatTime":1677945713,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:01:54+08:00","userKey":238}
{"appID":0,"data":"{\"seq\":\"1677945713172-697325\",\"cmd\":\"msg\",\"response\":{\"code\":0,\"codeMsg\":\"Ok\",\"data\":{\"to\":\"\",\"type\":\"text\",\"msg\":\"sad\",\"from\":\"九江王英布\"}}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/user_srv.go:140","func":"bychat/internal/servers/websocket.AllSendMessages","level":"info","msg":"全员广播","roomID":101,"time":"2023-03-05T00:01:54+08:00","userID":238}
{"file":"/home/luo/go_project/bychat/cmd/main.go:59","func":"main.LoggerToFile.func1","level":"info","msg":"map[clientIp:::1 cost:3.79 method:POST statusCode:200 uri:/user/sendMessageAll]","time":"2023-03-05T00:01:54+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:60","func":"bychat/internal/servers/websocket.(*Client).read","level":"info","msg":"读取客户端数据 处理:{\"seq\":\"1677945722628-867145\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","time":"2023-03-05T00:02:04+08:00"}
{"addr":"","data":"{\"seq\":\"1677945722628-867145\",\"cmd\":\"heartbeat\",\"data\":{\"userID\":238}}","file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:42","func":"bychat/internal/servers/websocket.ProcessData","level":"info","msg":"ProcessData Request","time":"2023-03-05T00:02:04+08:00"}
{"UserId":238,"file":"/home/luo/go_project/bychat/internal/servers/websocket/server.go:51","func":"bychat/internal/servers/websocket.Heartbeat","level":"info","msg":"webSocket_request 心跳接口","time":"2023-03-05T00:02:04+08:00"}
{"HeartbeatTime":1677945713,"IsLogoff":false,"LoginTime":1677945683,"file":"/home/luo/go_project/bychat/lib/cache/user_cache.go:67","func":"bychat/lib/cache.GetUserOnlineInfo","level":"info","msg":"获取用户在线数据","time":"2023-03-05T00:02:04+08:00","userKey":238}
{"cmd":"heartbeat","code":0,"file":"/home/luo/go_project/bychat/internal/servers/websocket/acc_process.go:92","func":"bychat/internal/servers/websocket.ProcessData","headByte":"{\"seq\":\"1677945722628-867145\",\"cmd\":\"heartbeat\",\"response\":{\"code\":0,\"codeMsg\":\"Success\",\"data\":null}}","level":"info","msg":"acc_response send","time":"2023-03-05T00:02:04+08:00"}
{"Addr":"","err":"websocket: close 1001 (going away)","file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:55","func":"bychat/internal/servers/websocket.(*Client).read","level":"error","msg":"读取客户端数据 错误","time":"2023-03-05T00:02:04+08:00"}
{"file":"/home/luo/go_project/bychat/internal/servers/websocket/client.go:45","func":"bychat/internal/servers/websocket.(*Client).read.func2","level":"info","msg":"读取客户端数据 关闭send\u0026{0 238 [::1]:52376     0xc0005a69a0 0xc0000925a0 1677945683 1677945724 1677945683}","time":"2023-03-05T00:02:04+08:00"}
